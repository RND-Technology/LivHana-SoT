<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VibeClient - Conversation Analysis & Master Prompt Generator</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .message-container {
            max-height: 400px;
            overflow-y: auto;
        }
        .message-container::-webkit-scrollbar {
            width: 6px;
        }
        .message-container::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }
        .message-container::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 3px;
        }
        .message-container::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .pulse-button {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div id="app" class="container mx-auto px-4 py-8 max-w-4xl">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-800 mb-2">VibeClient</h1>
            <p class="text-gray-600">Conversation Analysis & Master Prompt Generator</p>
            <div class="mt-4 p-4 bg-blue-50 rounded-lg border-l-4 border-blue-400">
                <p class="text-sm text-blue-800">
                    <strong>Purpose:</strong> Refine your concept through conversation, then generate a perfect one-shot prompt that captures your ultimate goal.
                </p>
            </div>
        </div>

        <!-- Main Application Container -->
        <div class="bg-white rounded-lg shadow-lg overflow-hidden">
            <!-- Chat Interface -->
            <div class="p-6 border-b border-gray-200">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">Conversation History</h2>
                
                <!-- Messages Container -->
                <div class="message-container bg-gray-50 rounded-lg p-4 mb-4" style="min-height: 300px;">
                    <div v-if="messages.length === 0" class="text-center text-gray-500 py-8">
                        <div class="text-6xl mb-4">ðŸ’¬</div>
                        <p>Start a conversation to refine your concept...</p>
                    </div>
                    <div v-for="(message, index) in messages" :key="index" 
                         class="mb-4 fade-in" 
                         :class="message.type === 'user' ? 'text-right' : 'text-left'">
                        <div class="inline-block max-w-xs lg:max-w-md px-4 py-2 rounded-lg"
                             :class="message.type === 'user' 
                                ? 'bg-blue-500 text-white' 
                                : 'bg-white text-gray-800 border border-gray-200'">
                            <div class="text-sm font-medium mb-1" 
                                 :class="message.type === 'user' ? 'text-blue-100' : 'text-gray-600'">
                                {{ message.type === 'user' ? 'You' : 'AI Assistant' }}
                            </div>
                            <div class="whitespace-pre-wrap">{{ message.content }}</div>
                            <div class="text-xs mt-1 opacity-70">
                                {{ formatTime(message.timestamp) }}
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Message Input -->
                <div class="flex gap-2">
                    <textarea 
                        v-model="newMessage" 
                        @keydown.enter.prevent="sendMessage"
                        placeholder="Type your message here... (Shift+Enter for new line)"
                        class="flex-1 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
                        rows="3"
                        :disabled="isGenerating">
                    </textarea>
                    <button 
                        @click="sendMessage"
                        :disabled="!newMessage.trim() || isGenerating"
                        class="px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors">
                        Send
                    </button>
                </div>
            </div>

            <!-- Analysis Section -->
            <div class="p-6 bg-gradient-to-r from-purple-50 to-blue-50">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">Master Prompt Generation</h2>
                <p class="text-gray-600 mb-4">
                    Analyze your entire conversation to generate a perfect one-shot prompt that captures your ultimate goal.
                </p>
                
                <button 
                    @click="generateMasterPrompt"
                    :disabled="messages.length === 0 || isGenerating"
                    class="w-full py-4 px-6 bg-gradient-to-r from-purple-500 to-blue-500 text-white rounded-lg hover:from-purple-600 hover:to-blue-600 disabled:from-gray-300 disabled:to-gray-300 disabled:cursor-not-allowed transition-all duration-200 font-semibold text-lg"
                    :class="{ 'pulse-button': messages.length > 0 && !isGenerating }">
                    <span v-if="!isGenerating">
                        ðŸ§  Analyze Conversation & Generate Master Prompt
                    </span>
                    <span v-else class="flex items-center justify-center">
                        <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                        </svg>
                        Analyzing...
                    </span>
                </button>
            </div>

            <!-- Master Prompt Output -->
            <div v-if="masterPrompt" class="p-6 bg-green-50 border-t border-green-200">
                <h3 class="text-lg font-semibold text-green-800 mb-4 flex items-center">
                    âœ¨ Generated Master Prompt
                    <button @click="copyToClipboard" 
                            class="ml-auto px-3 py-1 bg-green-500 text-white text-sm rounded hover:bg-green-600 transition-colors">
                        {{ copySuccess ? 'Copied!' : 'Copy' }}
                    </button>
                </h3>
                <div class="bg-white border border-green-200 rounded-lg p-4">
                    <pre class="whitespace-pre-wrap text-sm text-gray-800 font-mono leading-relaxed">{{ masterPrompt }}</pre>
                </div>
                <div class="mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg">
                    <p class="text-sm text-yellow-800">
                        <strong>ðŸ’¡ Usage:</strong> Copy this prompt and use it in a new, clean session with any AI assistant. 
                        It should generate your desired output perfectly on the first try.
                    </p>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="text-center mt-8 text-gray-500 text-sm">
            <p>VibeClient - Transform conversations into perfect prompts</p>
        </div>
    </div>

    <script>
        const { createApp, ref, onMounted, nextTick } = Vue;

        createApp({
            setup() {
                // Reactive state
                const messages = ref([]);
                const newMessage = ref('');
                const masterPrompt = ref('');
                const isGenerating = ref(false);
                const copySuccess = ref(false);

                // Load conversation from localStorage on mount
                onMounted(() => {
                    loadConversation();
                });

                // Load conversation from localStorage
                const loadConversation = () => {
                    try {
                        const saved = localStorage.getItem('vibeclient_conversation');
                        if (saved) {
                            messages.value = JSON.parse(saved);
                        }
                    } catch (error) {
                        console.error('Failed to load conversation:', error);
                    }
                };

                // Save conversation to localStorage
                const saveConversation = () => {
                    try {
                        localStorage.setItem('vibeclient_conversation', JSON.stringify(messages.value));
                    } catch (error) {
                        console.error('Failed to save conversation:', error);
                    }
                };

                // Format timestamp for display
                const formatTime = (timestamp) => {
                    return new Date(timestamp).toLocaleTimeString([], { 
                        hour: '2-digit', 
                        minute: '2-digit' 
                    });
                };

                // Send message
                const sendMessage = async () => {
                    if (!newMessage.value.trim() || isGenerating.value) return;

                    const userMessage = {
                        type: 'user',
                        content: newMessage.value.trim(),
                        timestamp: Date.now()
                    };

                    messages.value.push(userMessage);
                    const currentMessage = newMessage.value;
                    newMessage.value = '';
                    
                    saveConversation();

                    // Simulate AI response (in a real app, this would call an API)
                    isGenerating.value = true;
                    
                    try {
                        // Simulate API delay
                        await new Promise(resolve => setTimeout(resolve, 1000 + Math.random() * 2000));
                        
                        const aiResponse = await generateAIResponse(currentMessage);
                        
                        const aiMessage = {
                            type: 'ai',
                            content: aiResponse,
                            timestamp: Date.now()
                        };
                        
                        messages.value.push(aiMessage);
                        saveConversation();
                    } catch (error) {
                        console.error('Error generating AI response:', error);
                        const errorMessage = {
                            type: 'ai',
                            content: 'Sorry, I encountered an error. Please try again.',
                            timestamp: Date.now()
                        };
                        messages.value.push(errorMessage);
                        saveConversation();
                    } finally {
                        isGenerating.value = false;
                    }
                };

                // Generate AI response (mock implementation)
                const generateAIResponse = async (userMessage) => {
                    // This is a mock implementation. In a real app, you would call an AI API here.
                    const responses = [
                        "That's an interesting approach. Can you tell me more about the specific challenges you're facing?",
                        "I see what you're trying to achieve. What would success look like for this project?",
                        "That's a good point. Have you considered alternative approaches to this problem?",
                        "I understand your goal. What are the key requirements or constraints you need to work within?",
                        "That's a solid foundation. What specific aspects would you like to refine or improve?",
                        "I can help you develop this further. What's the most important outcome you want to achieve?",
                        "That's a creative solution. How do you envision this working in practice?",
                        "I see the potential here. What would be the next logical step to move this forward?",
                        "That's a thoughtful approach. What resources or tools would you need to make this happen?",
                        "I understand your vision. What would be the biggest challenge in implementing this?"
                    ];
                    
                    // Simple keyword-based response selection (in a real app, this would be AI-generated)
                    const message = userMessage.toLowerCase();
                    if (message.includes('help') || message.includes('assist')) {
                        return "I'm here to help you refine your concept. What specific aspect would you like to work on?";
                    } else if (message.includes('problem') || message.includes('issue')) {
                        return "I can help you work through that problem. Can you describe the specific challenges you're encountering?";
                    } else if (message.includes('idea') || message.includes('concept')) {
                        return "That sounds like a promising idea! What makes this concept unique or valuable?";
                    } else {
                        return responses[Math.floor(Math.random() * responses.length)];
                    }
                };

                // Generate master prompt from conversation
                const generateMasterPrompt = async () => {
                    if (messages.value.length === 0 || isGenerating.value) return;

                    isGenerating.value = true;
                    copySuccess.value = false;

                    try {
                        // Simulate API delay
                        await new Promise(resolve => setTimeout(resolve, 2000 + Math.random() * 3000));
                        
                        const conversationHistory = messages.value.map(msg => 
                            `${msg.type === 'user' ? 'User' : 'AI'}: ${msg.content}`
                        ).join('\n\n');

                        const analysisPrompt = createAnalysisPrompt(conversationHistory);
                        
                        // In a real app, this would call an AI API with the analysis prompt
                        // For now, we'll generate a mock master prompt
                        const generatedPrompt = await generateMockMasterPrompt(conversationHistory);
                        
                        masterPrompt.value = generatedPrompt;
                    } catch (error) {
                        console.error('Error generating master prompt:', error);
                        masterPrompt.value = 'Error generating master prompt. Please try again.';
                    } finally {
                        isGenerating.value = false;
                    }
                };

                // Create the analysis prompt for the AI
                const createAnalysisPrompt = (conversationHistory) => {
                    return `You are an expert prompt engineer and conversation analyst. Your task is to analyze the following conversation between a user and an AI assistant, then generate a single, perfect one-shot prompt that would have achieved the user's ultimate goal from the start.

CONVERSATION HISTORY:
${conversationHistory}

ANALYSIS INSTRUCTIONS:
1. Identify the user's core objective or desired outcome
2. Note any specific requirements, constraints, or preferences mentioned
3. Identify successful approaches or solutions that emerged during the conversation
4. Note any failures, dead ends, or ineffective approaches that were tried
5. Extract key insights about what works and what doesn't for this specific use case

MASTER PROMPT REQUIREMENTS:
- Be comprehensive and self-contained (no need for follow-up questions)
- Include all necessary context and background information
- Specify the exact format and style of output desired
- Include any specific constraints or requirements mentioned
- Be clear and unambiguous in instructions
- Optimize for first-try success

Generate a master prompt that would have produced the user's desired result perfectly on the first attempt.`;
                };

                // Generate mock master prompt (in a real app, this would call an AI API)
                const generateMockMasterPrompt = async (conversationHistory) => {
                    // Analyze the conversation to extract key themes
                    const userMessages = messages.value.filter(msg => msg.type === 'user');
                    const aiMessages = messages.value.filter(msg => msg.type === 'ai');
                    
                    // Extract key themes from the conversation
                    const allText = conversationHistory.toLowerCase();
                    const themes = [];
                    
                    if (allText.includes('code') || allText.includes('programming') || allText.includes('function')) {
                        themes.push('programming/development');
                    }
                    if (allText.includes('design') || allText.includes('ui') || allText.includes('interface')) {
                        themes.push('design/user interface');
                    }
                    if (allText.includes('business') || allText.includes('strategy') || allText.includes('plan')) {
                        themes.push('business strategy');
                    }
                    if (allText.includes('analysis') || allText.includes('data') || allText.includes('research')) {
                        themes.push('data analysis');
                    }
                    if (allText.includes('creative') || allText.includes('writing') || allText.includes('content')) {
                        themes.push('creative content');
                    }

                    // Generate a comprehensive master prompt based on the conversation
                    const primaryTheme = themes[0] || 'general assistance';
                    const userGoal = userMessages[0]?.content || 'achieve a specific objective';
                    
                    return `# Master Prompt: ${primaryTheme.charAt(0).toUpperCase() + primaryTheme.slice(1)} Expert

## Your Role & Expertise
You are a world-class expert in ${primaryTheme} with deep knowledge and practical experience. You excel at understanding complex requirements and delivering comprehensive, actionable solutions.

## Context & Background
Based on our previous conversation, the user is seeking assistance with: "${userGoal}"

## Your Task
Provide a complete, professional solution that addresses the user's core objective. Your response should be:

1. **Comprehensive**: Cover all aspects of the request thoroughly
2. **Actionable**: Include specific steps, code, or instructions that can be implemented immediately
3. **Professional**: Use industry best practices and standards
4. **Complete**: Be self-contained with no need for follow-up questions
5. **Optimized**: Designed for immediate success and implementation

## Output Format
Structure your response as follows:
- **Overview**: Brief summary of the solution
- **Detailed Implementation**: Step-by-step approach with specific details
- **Code/Examples**: If applicable, provide working code or concrete examples
- **Best Practices**: Include relevant guidelines and recommendations
- **Next Steps**: Clear action items for moving forward

## Quality Standards
- Ensure all information is accurate and up-to-date
- Use clear, professional language
- Provide practical, implementable solutions
- Include relevant context and background information
- Anticipate potential challenges and address them proactively

Deliver a solution that exceeds expectations and provides immediate value.`;
                };

                // Copy to clipboard
                const copyToClipboard = async () => {
                    try {
                        await navigator.clipboard.writeText(masterPrompt.value);
                        copySuccess.value = true;
                        setTimeout(() => {
                            copySuccess.value = false;
                        }, 2000);
                    } catch (error) {
                        console.error('Failed to copy to clipboard:', error);
                        // Fallback for older browsers
                        const textArea = document.createElement('textarea');
                        textArea.value = masterPrompt.value;
                        document.body.appendChild(textArea);
                        textArea.select();
                        document.execCommand('copy');
                        document.body.removeChild(textArea);
                        copySuccess.value = true;
                        setTimeout(() => {
                            copySuccess.value = false;
                        }, 2000);
                    }
                };

                return {
                    messages,
                    newMessage,
                    masterPrompt,
                    isGenerating,
                    copySuccess,
                    sendMessage,
                    generateMasterPrompt,
                    copyToClipboard,
                    formatTime
                };
            }
        }).mount('#app');
    </script>
</body>
</html>
