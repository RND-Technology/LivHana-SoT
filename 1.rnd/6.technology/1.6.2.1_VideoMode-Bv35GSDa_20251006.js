var e=(e,n,s)=>new Promise((t,r)=>{var o=e=>{try{c(s.next(e))}catch(n){r(n)}},i=e=>{try{c(s.throw(e))}catch(n){r(n)}},c=e=>e.done?t(e.value):Promise.resolve(e.value).then(o,i);c((s=s.apply(e,n)).next())});import{j as n,x as s,y as t,B as r,z as o,N as i,m as c,n as a,b as l,F as d,E as u,G as x,M as h,I as g,P as j,f as p,C as m,K as b,o as v}from"./vendor-mui-core-q5oQAHKb.js";import{r as f}from"./vendor-react-D4912goE.js";import{a as C,j as k,k as y,n as E,o as A,p as w,F as S,q as I,r as F,G as D,s as T,t as R}from"./vendor-mui-icons-fVC7fdhd.js";const B=({open:B,onClose:M,videoModeActive:V,toggleVideoMode:L,agentStatus:P,setAgentStatus:W})=>{const[H,z]=f.useState(null),[O,q]=f.useState(null),[G,Y]=f.useState(!1),[K,N]=f.useState(!1),[Q,U]=f.useState(!0),[X,J]=f.useState(!1),[Z,$]=f.useState("high"),[_,ee]=f.useState([{id:"liv-hana",name:"Liv Hana AI",status:"connected",avatar:"ðŸ¤–"},{id:"user",name:"You",status:"connected",avatar:"ðŸ‘¤"}]),[ne,se]=f.useState("disconnected"),[te,re]=f.useState(!1),oe=f.useRef(null),ie=f.useRef(null),ce=f.useRef(null),ae=f.useRef(null),le=f.useMemo(()=>({iceServers:[{urls:"turn:openrelay.metered.ca:80",username:"openrelayproject",credential:"openrelayproject"},{urls:"stun:stun.l.google.com:19302"}]}),[]),de=f.useCallback(()=>e(void 0,null,function*(){if(!G)try{se("connecting"),W("connecting");const e=yield navigator.mediaDevices.getUserMedia({video:"high"===Z?{width:1280,height:720}:"medium"===Z?{width:640,height:480}:{width:320,height:240},audio:!0});z(e),oe.current&&(oe.current.srcObject=e);const n=new RTCPeerConnection(le);ce.current=n,e.getTracks().forEach(s=>{n.addTrack(s,e)}),n.ontrack=e=>{const n=e.streams[0];q(n),ie.current&&(ie.current.srcObject=n)},n.onicecandidate=e=>{e.candidate},n.onconnectionstatechange=()=>{const e=n.connectionState;se(e),"connected"===e?(Y(!0),W("video-ready")):"disconnected"!==e&&"failed"!==e&&"closed"!==e||(Y(!1),W("ready"))};const s=yield n.createOffer();yield n.setLocalDescription(s),setTimeout(()=>{se("connected"),Y(!0),W("video-ready")},2e3)}catch(e){se("error"),W("error")}}),[G,Z,le,se,W]),ue=f.useCallback(()=>{Y(!1),U(!1),N(!1),J(!1),ce.current&&(ce.current.close(),ce.current=null),H&&(H.getTracks().forEach(e=>e.stop()),z(null)),ae.current&&(ae.current.getTracks().forEach(e=>e.stop()),ae.current=null),q(null),se("disconnected"),W("ready")},[H,Y,U,N,J,q,se,W]),xe=f.useCallback(()=>e(void 0,null,function*(){if(X)he();else try{const e=yield navigator.mediaDevices.getDisplayMedia({video:!0,audio:!0});if(ae.current=e,ce.current){const n=ce.current.getSenders().find(e=>e.track&&"video"===e.track.kind);n&&n.replaceTrack(e.getVideoTracks()[0])}J(!0),e.getVideoTracks()[0].addEventListener("ended",()=>{he()})}catch(e){}}),[X,he]),he=f.useCallback(()=>{if(ae.current&&(ae.current.getTracks().forEach(e=>e.stop()),ae.current=null),ce.current&&H){const e=ce.current.getSenders().find(e=>e.track&&"video"===e.track.kind);e&&e.replaceTrack(H.getVideoTracks()[0])}J(!1)},[H]),ge=f.useCallback(()=>{document.fullscreenElement?(document.exitFullscreen(),re(!1)):(document.documentElement.requestFullscreen(),re(!0))},[]);return f.useEffect(()=>(V&&!G?de():V||ue(),()=>{ue()}),[V,ue,G,de]),f.useEffect(()=>{const e=()=>{re(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",e),()=>document.removeEventListener("fullscreenchange",e)},[]),n.jsxs(s,{open:B,onClose:M,maxWidth:"xl",fullWidth:!0,fullScreen:te,PaperProps:{sx:{backgroundColor:"#1a1a1a",color:"white",minHeight:"600px",maxHeight:"90vh"}},children:[n.jsx(t,{sx:{color:"#F59E0B",fontWeight:"bold",fontSize:"1.5rem"},children:n.jsxs(r,{display:"flex",alignItems:"center",gap:2,children:[n.jsx(C,{sx:{fontSize:28}}),"Liv Hana Video Conference Center"]})}),n.jsxs(o,{children:[n.jsx(r,{sx:{mb:3},children:n.jsxs(i,{container:!0,spacing:2,sx:{height:"400px"},children:[n.jsx(i,{item:!0,xs:12,md:6,children:n.jsx(c,{sx:{backgroundColor:"#2d2d2d",height:"100%"},children:n.jsx(a,{sx:{p:1,height:"100%"},children:n.jsxs(r,{sx:{position:"relative",width:"100%",height:"100%"},children:[n.jsx("video",{ref:oe,autoPlay:!0,muted:!0,playsInline:!0,style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"8px",transform:"scaleX(-1)"}}),!Q&&n.jsx(r,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"#374151",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px"},children:n.jsx(l,{variant:"h3",children:"ðŸ“¹"})}),n.jsx(r,{sx:{position:"absolute",bottom:8,left:8,backgroundColor:"rgba(0,0,0,0.7)",px:1,py:.5,borderRadius:1},children:n.jsxs(l,{variant:"caption",sx:{color:"white"},children:["You ",K&&"ðŸ”‡"]})})]})})})}),n.jsx(i,{item:!0,xs:12,md:6,children:n.jsx(c,{sx:{backgroundColor:"#2d2d2d",height:"100%"},children:n.jsx(a,{sx:{p:1,height:"100%"},children:n.jsxs(r,{sx:{position:"relative",width:"100%",height:"100%"},children:[O?n.jsx("video",{ref:ie,autoPlay:!0,playsInline:!0,style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"8px"}}):n.jsxs(r,{sx:{width:"100%",height:"100%",background:"linear-gradient(135deg, #F59E0B 0%, #16A34A 100%)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",borderRadius:"8px",border:"2px solid rgba(245, 158, 11, 0.3)"},children:[n.jsx(l,{variant:"h2",sx:{mb:2},children:"ðŸ¤–"}),n.jsx(l,{variant:"h6",children:"Liv Hana AI"}),n.jsx(l,{variant:"body2",sx:{opacity:.8},children:"connecting"===ne?"Connecting...":"connected"===ne?"Connected":"Waiting..."})]}),n.jsx(r,{sx:{position:"absolute",bottom:8,left:8,backgroundColor:"rgba(0,0,0,0.7)",px:1,py:.5,borderRadius:1},children:n.jsx(l,{variant:"caption",sx:{color:"white"},children:"Liv Hana AI"})})]})})})})]})}),n.jsx(r,{sx:{mb:3},children:n.jsxs(i,{container:!0,spacing:2,alignItems:"center",children:[n.jsx(i,{item:!0,xs:12,md:4,children:n.jsxs(d,{fullWidth:!0,size:"small",children:[n.jsx(u,{sx:{color:"#E5E7EB"},children:"Video Quality"}),n.jsxs(x,{value:Z,onChange:e=>$(e.target.value),sx:{color:"white","& .MuiSelect-icon":{color:"#F59E0B"},"& .MuiOutlinedInput-notchedOutline":{borderColor:"#374151"}},children:[n.jsx(h,{value:"low",children:"Low (320x240)"}),n.jsx(h,{value:"medium",children:"Medium (640x480)"}),n.jsx(h,{value:"high",children:"High (1280x720)"})]})]})}),n.jsx(i,{item:!0,xs:12,md:8,children:n.jsxs(r,{sx:{display:"flex",gap:1,justifyContent:"center",flexWrap:"wrap"},children:[n.jsx(g,{onClick:()=>{if(H){const e=H.getAudioTracks()[0];e&&(e.enabled=!e.enabled,N(!e.enabled))}},sx:{backgroundColor:K?"#EF4444":"#16A34A",color:"white","&:hover":{backgroundColor:K?"#DC2626":"#15803D"}},children:K?n.jsx(k,{}):n.jsx(y,{})}),n.jsx(g,{onClick:()=>{if(H){const e=H.getVideoTracks()[0];e&&(e.enabled=!e.enabled,U(e.enabled))}},sx:{backgroundColor:Q?"#16A34A":"#EF4444",color:"white","&:hover":{backgroundColor:Q?"#15803D":"#DC2626"}},children:Q?n.jsx(C,{}):n.jsx(E,{})}),n.jsx(g,{onClick:xe,sx:{backgroundColor:X?"#F59E0B":"#16A34A",color:"white","&:hover":{backgroundColor:X?"#D97706":"#15803D"}},children:X?n.jsx(A,{}):n.jsx(w,{})}),n.jsx(g,{onClick:ge,sx:{backgroundColor:"#374151",color:"white","&:hover":{backgroundColor:"#4B5563"}},children:te?n.jsx(S,{}):n.jsx(I,{})}),n.jsx(g,{onClick:ue,sx:{backgroundColor:"#EF4444",color:"white","&:hover":{backgroundColor:"#DC2626"}},children:n.jsx(F,{})})]})})]})}),n.jsxs(j,{sx:{p:2,backgroundColor:"#374151"},children:[n.jsxs(r,{display:"flex",alignItems:"center",gap:2,mb:2,children:[n.jsx(D,{sx:{color:"#16A34A"}}),n.jsxs(l,{variant:"h6",sx:{color:"#16A34A"},children:["Participants (",_.length,")"]})]}),n.jsx(r,{display:"flex",gap:2,flexWrap:"wrap",children:_.map(e=>n.jsxs(r,{display:"flex",alignItems:"center",gap:1,children:[n.jsx(p,{sx:{bgcolor:"liv-hana"===e.id?"#F59E0B":"#16A34A"},children:e.avatar}),n.jsxs(r,{children:[n.jsx(l,{variant:"body2",fontWeight:"medium",children:e.name}),n.jsx(m,{label:e.status,size:"small",color:"connected"===e.status?"success":"default"})]})]},e.id))})]}),n.jsx(j,{sx:{mt:2,p:2,backgroundColor:"#374151"},children:n.jsxs(r,{display:"flex",alignItems:"center",gap:2,justifyContent:"space-between",children:[n.jsxs(r,{display:"flex",alignItems:"center",gap:2,children:["connected"===ne?n.jsx(T,{sx:{color:"#16A34A"}}):"connecting"===ne?n.jsx(R,{sx:{color:"#F59E0B"}}):n.jsx(R,{sx:{color:"#EF4444"}}),n.jsxs(l,{variant:"body2",children:["Connection: ","connected"===ne?"Connected":"connecting"===ne?"Connecting...":"Disconnected"]})]}),n.jsxs(r,{display:"flex",alignItems:"center",gap:2,children:[n.jsxs(l,{variant:"body2",sx:{color:"#16A34A"},children:["Video Mode: ",V?"Active":"Inactive"]}),n.jsxs(l,{variant:"body2",children:["Agent Status: ",P]})]})]})})]}),n.jsxs(b,{sx:{justifyContent:"space-between",p:3},children:[n.jsx(v,{onClick:M,variant:"outlined",sx:{borderColor:"#374151",color:"#E5E7EB"},children:"Close"}),n.jsx(r,{display:"flex",gap:2,children:n.jsx(v,{onClick:L,variant:"contained",startIcon:V?n.jsx(E,{}):n.jsx(C,{}),sx:{backgroundColor:V?"#EF4444":"#16A34A","&:hover":{backgroundColor:V?"#DC2626":"#15803D"}},children:V?"End Video Session":"Start Video Session"})})]})]})};export{B as default};
