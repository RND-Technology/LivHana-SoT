import{j as e}from"./vendor-mui-core-q5oQAHKb.js";import{r as t}from"./vendor-react-D4912goE.js";import{a}from"./vendor-http-DpZCZaHO.js";import{m as r,A as l}from"./vendor-animation-BsmF1KEO.js";const s=()=>{const[l,s]=t.useState([]),[c,m]=t.useState(!0),[x,u]=t.useState(!1),[p,g]=t.useState([]),[b,h]=t.useState(null),[y,f]=t.useState("mock"),v=t.useMemo(()=>({"reggieanddro.com":{brand:"Reggie & Dro",tagline:"Premium Texas Hemp Since 2020",primaryColor:"#16A34A",logo:"ðŸŒ¿"},"herbitrage.com":{brand:"Herbitrage",tagline:"Cannabis Price Intelligence",primaryColor:"#059669",logo:"ðŸ“Š"},"oneplantsolution.com":{brand:"One Plant Solution",tagline:"Your Complete Cannabis Resource",primaryColor:"#10B981",logo:"ðŸŒ±"},"highnooncartoon.com":{brand:"High Noon Cartoon",tagline:"Cannabis Culture & Entertainment",primaryColor:"#F59E0B",logo:"ðŸŽ­"},"cannabisretailai.com":{brand:"Cannabis Retail AI",tagline:"Smart Cannabis Commerce",primaryColor:"#8B5CF6",logo:"ðŸ¤–"},"freeweedtexas.com":{brand:"Free Weed Texas",tagline:"Legal Hemp Liberation",primaryColor:"#EF4444",logo:"ðŸ”¥"}}),[]),j=t.useMemo(()=>{const e="undefined"!=typeof window?window.location.hostname:"";return v[e]||v["reggieanddro.com"]},[v]);t.useEffect(()=>{x&&(()=>{return e=void 0,t=null,r=function*(){let e,t;try{const e=new AbortController,t=setTimeout(()=>e.abort(),1e4),{data:r}=yield a.get("https://reasoning-gateway-980910443251.us-central1.run.app/api/square/catalog",{signal:e.signal,timeout:1e4});clearTimeout(t);const l=r.products&&Array.isArray(r.products)?r.products:N(r.objects||[]);0===l.length?(s(w()),f("demo-fallback")):(s(l),f(r.source||"square-api"))}catch(r){"ECONNABORTED"===r.code||r.message.includes("timeout")||401===(null==(e=r.response)?void 0:e.status)||null==(t=r.response)||t.status,s(w()),f("offline-fallback")}finally{m(!1)}},new Promise((a,l)=>{var s=e=>{try{o(r.next(e))}catch(t){l(t)}},n=e=>{try{o(r.throw(e))}catch(t){l(t)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(s,n);o((r=r.apply(e,t)).next())});let e,t,r})()},[x]);const C=(e,t)=>{if(!e)return null;const a=new RegExp(`${t}[:\\s]*(\\d+\\.?\\d*)%`,"i"),r=e.match(a);return r?`${r[1]}%`:null},N=e=>e.filter(e=>"ITEM"===e.type).map(e=>{let t,a,r,l,s,n,o,i,c,d,m,x,u,p;const g=(null==(r=null==(a=null==(t=e.item_data)?void 0:t.variations)?void 0:a[0])?void 0:r.item_variation_data)||{};return{id:e.id,name:(null==(l=e.item_data)?void 0:l.name)||"Unnamed Product",description:(null==(s=e.item_data)?void 0:s.description)||"",price:(null==(n=g.price_money)?void 0:n.amount)?g.price_money.amount/100:0,sku:g.sku||"",category:(null==(c=null==(i=null==(o=e.item_data)?void 0:o.categories)?void 0:i[0])?void 0:c.name)||"Hemp Product",image:(null==(d=e.item_data)?void 0:d.image_url)||null,inventory:null!=(m=g.inventory_count)?m:0,thca:C(null==(x=e.item_data)?void 0:x.description,"THCA"),cbd:C(null==(u=e.item_data)?void 0:u.description,"CBD"),delta8:C(null==(p=e.item_data)?void 0:p.description,"Delta"),lab:`COA-${e.id.slice(-8)}`}}),w=()=>[{id:"DEMO-THCA",name:"Tier-1 THCA Flower - 3.5g",description:"Indoor grown THCA flower. THCA: 23.5%. Texas compliant.",price:45,sku:"THCA-IND-35",category:"THCA Flower",inventory:120,thca:"23.5%",cbd:"0.3%",lab:"COA-DEMO-THCA"},{id:"DEMO-CBD",name:"Texas CBD Flower - 7g",description:"Sun grown CBD hemp. CBD: 18.5%, THC <0.3%.",price:38,sku:"CBD-TX-7",category:"CBD Flower",inventory:90,cbd:"18.5%",thca:"0.2%",lab:"COA-DEMO-CBD"}];return x?c?e.jsxs("div",{className:"min-h-screen bg-black flex items-center justify-center flex-col gap-4",children:[e.jsx(r.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"text-6xl",children:"ðŸŒ¿"}),e.jsx("div",{className:"text-green-400 text-lg font-semibold",children:"Loading products..."}),e.jsx("div",{className:"text-gray-500 text-sm",children:"Fetching real-time inventory from Square"})]}):e.jsxs("div",{className:"min-h-screen bg-black text-white",children:[e.jsx(o,{currentDomain:j,cartItems:p,source:y}),e.jsx(i,{products:l,currentDomain:j,cartItems:p,setCartItems:g,setSelectedProduct:h}),e.jsx(d,{product:b,onClose:()=>h(null)})]}):e.jsx(n,{currentDomain:j,onVerify:()=>u(!0)})},n=({currentDomain:t,onVerify:a})=>e.jsx(r.div,{className:"fixed inset-0 bg-black bg-opacity-95 z-50 flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},children:e.jsxs(r.div,{className:"bg-gradient-to-br from-green-900 to-gray-900 p-12 rounded-2xl border-4 border-green-500 max-w-lg",initial:{scale:.8},animate:{scale:1},transition:{type:"spring"},children:[e.jsx("div",{className:"text-6xl text-center mb-4",children:t.logo}),e.jsx("h1",{className:"text-4xl font-bold text-green-400 mb-2 text-center",children:t.brand}),e.jsx("p",{className:"text-gray-400 mb-6 text-center",children:t.tagline}),e.jsx("h2",{className:"text-2xl font-bold text-yellow-400 mb-4 text-center",children:"AGE VERIFICATION REQUIRED"}),e.jsx("p",{className:"text-gray-300 mb-6 text-center",children:"You must be 21+ to enter. Texas law requires age verification for hemp products."}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"date",id:"birthdate-input",required:!0,className:"w-full p-4 bg-black border-2 border-green-500 rounded-lg text-green-400",max:new Date((new Date).setFullYear((new Date).getFullYear()-21)).toISOString().split("T")[0],onChange:e=>{if(!e.target.value)return;const t=new Date(e.target.value);Math.floor((Date.now()-t.getTime())/315576e5)>=21&&e.target.value&&a()}}),e.jsx(r.button,{onClick:()=>{const e=document.getElementById("birthdate-input");if(!(null==e?void 0:e.value))return void alert("Please enter your date of birth to verify you are 21+");const t=new Date(e.value);Math.floor((Date.now()-t.getTime())/315576e5)>=21?a():alert("You must be 21 or older to access this content.")},className:"w-full py-4 bg-gradient-to-r from-green-500 to-green-600 text-black font-bold rounded-lg",whileHover:{scale:1.02},whileTap:{scale:.98},children:"VERIFY AGE & ENTER"}),e.jsx("p",{className:"text-xs text-gray-500 text-center",children:"By entering, you agree to our Terms of Service and Privacy Policy. Square securely processes all transactions."})]})]})}),o=({currentDomain:t,cartItems:a,source:l})=>e.jsx("header",{className:"border-b border-gray-800 py-6",children:e.jsx("div",{className:"container mx-auto px-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("span",{className:"text-4xl",children:t.logo}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",style:{color:t.primaryColor},children:t.brand}),e.jsx("p",{className:"text-sm text-gray-400",children:t.tagline}),e.jsx("p",{className:"text-xs uppercase tracking-wide font-semibold "+("square-api"===l?"text-green-400":"offline-fallback"===l?"text-red-400":"demo-fallback"===l?"text-yellow-400":"text-gray-500"),children:"square-api"===l?"Live Square Data":"offline-fallback"===l?"Offline - Demo Products":"demo-fallback"===l?"Empty Catalog - Demo Products":l})]})]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Cart Items"}),e.jsx("p",{className:"text-2xl font-bold",style:{color:t.primaryColor},children:a.length})]}),e.jsx(r.button,{className:"px-6 py-3 font-bold rounded-lg text-black",style:{backgroundColor:t.primaryColor},whileHover:{scale:1.05},whileTap:{scale:.95},children:"CHECKOUT"})]})]})})}),i=({products:t,currentDomain:a,cartItems:r,setCartItems:l,setSelectedProduct:s})=>e.jsx("div",{className:"container mx-auto px-6 py-12",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:t.map(t=>e.jsx(c,{product:t,currentDomain:a,cartItems:r,setCartItems:l,setSelectedProduct:s},t.id))})}),c=({product:t,currentDomain:a,cartItems:l,setCartItems:s,setSelectedProduct:n})=>e.jsxs(r.div,{className:"bg-gradient-to-br from-gray-900 to-black rounded-xl border-2 overflow-hidden",style:{borderColor:a.primaryColor},whileHover:{scale:1.02,boxShadow:`0 0 30px ${a.primaryColor}50`},children:[e.jsxs("div",{className:"relative h-64 bg-gradient-to-br from-gray-800 to-black",children:[null!==t.inventory&&t.inventory<50&&e.jsxs("div",{className:"absolute top-2 right-2 bg-red-600 text-white px-3 py-1 rounded-full text-sm font-bold animate-pulse",children:[t.inventory," LEFT"]}),t.image?e.jsx("img",{src:t.image,alt:t.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"flex items-center justify-center h-full text-6xl opacity-50",children:"ðŸŒ¿"}),e.jsxs("div",{className:"absolute bottom-2 left-2 bg-black bg-opacity-75 px-2 py-1 rounded text-xs text-gray-300",children:["SKU: ",t.sku]})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-bold mb-2",style:{color:a.primaryColor},children:t.name}),e.jsx("p",{className:"text-gray-400 text-sm mb-4",children:t.description}),e.jsxs("div",{className:"flex gap-2 mb-4 flex-wrap",children:[t.thca&&e.jsxs("span",{className:"bg-purple-900 text-purple-300 px-3 py-1 rounded-full text-xs",children:["THCA: ",t.thca]}),t.cbd&&e.jsxs("span",{className:"bg-blue-900 text-blue-300 px-3 py-1 rounded-full text-xs",children:["CBD: ",t.cbd]}),t.delta8&&e.jsxs("span",{className:"bg-orange-900 text-orange-300 px-3 py-1 rounded-full text-xs",children:["Î”8: ",t.delta8]}),e.jsx("span",{className:"bg-green-900 text-green-300 px-3 py-1 rounded-full text-xs",children:t.lab})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("span",{className:"text-3xl font-bold text-white",children:["$",t.price.toFixed(2)]}),null!==t.inventory&&t.inventory>0&&e.jsx("span",{className:"text-sm text-green-400 ml-2",children:"In Stock"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r.button,{onClick:()=>s([...l,t]),className:"w-full py-3 font-bold rounded-lg text-black",style:{backgroundColor:a.primaryColor},whileHover:{scale:1.02},whileTap:{scale:.98},children:"ADD TO CART"}),e.jsx("button",{onClick:()=>n(t),className:"w-full py-3 bg-gray-800 text-gray-300 rounded-lg border border-gray-700 hover:bg-gray-700",children:"VIEW LAB RESULTS"})]})]})]}),d=({product:t,onClose:a})=>e.jsx(l,{children:t&&e.jsx(r.div,{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:e.jsxs(r.div,{className:"bg-gray-900 p-8 rounded-xl max-w-lg w-full border border-gray-700",initial:{scale:.9},animate:{scale:1},exit:{scale:.9},children:[e.jsx("h2",{className:"text-2xl font-bold text-green-400 mb-4",children:t.name}),e.jsx("p",{className:"text-gray-300 mb-4",children:t.description}),e.jsxs("div",{className:"text-sm text-gray-400 space-y-2",children:[e.jsxs("p",{children:["SKU: ",t.sku]}),e.jsxs("p",{children:["Lab Certificate: ",t.lab]}),t.thca&&e.jsxs("p",{children:["THCA: ",t.thca]}),t.cbd&&e.jsxs("p",{children:["CBD: ",t.cbd]}),t.delta8&&e.jsxs("p",{children:["Delta-8: ",t.delta8]})]}),e.jsx("button",{onClick:a,className:"mt-6 w-full py-3 bg-green-500 text-black font-bold rounded-lg",children:"CLOSE"})]})})});export{s as default};
