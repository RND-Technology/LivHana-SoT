### 1. **Eliminate Client-Side Processing**

- Move ALL filtering to SQL WHERE clauses
- Replace JavaScript reduce() with SQL SUM()
- Use CASE WHEN for conditional aggregations
