# ğŸ—ï¸ SERVICE ARCHITECTURE RULES

## ğŸ“¦ MICROSERVICES STRUCTURE
```
backend/
â”œâ”€â”€ voice-service/        # ElevenLabs v3 voice I/O
â”œâ”€â”€ reasoning-gateway/    # DeepSeek 33B reasoning
â”œâ”€â”€ cannabis-service/     # Compliance & regulations
â”œâ”€â”€ payment-service/      # Stripe/Square integration
â”œâ”€â”€ integration-service/  # Lightspeed & external APIs
â”œâ”€â”€ product-service/      # Product catalog management
â””â”€â”€ common/              # Shared modules
    â”œâ”€â”€ auth/            # JWT authentication
    â”œâ”€â”€ queue/           # Redis queue management
    â”œâ”€â”€ guardrails/      # Safety filters
    â”œâ”€â”€ memory/          # Shared memory store
    â”œâ”€â”€ logging/         # Unified logging
    â””â”€â”€ validation/      # Input validation
```

## ğŸ”Œ SERVICE COMMUNICATION
- **Queue-Based**: All inter-service communication via Redis queues
- **Guardrails**: Every queue message passes through [backend/common/guardrails](mdc:backend/common/guardrails)
- **Authentication**: JWT tokens via [backend/common/auth](mdc:backend/common/auth)
- **Logging**: Centralized via [backend/common/logging](mdc:backend/common/logging)

## ğŸ³ DOCKER REQUIREMENTS
Each service MUST have:
- `Dockerfile` for containerization
- `package.json` with all dependencies
- Health check endpoint at `/health`
- Environment variables via `.env` files
- Integration with [docker-compose.yml](mdc:docker-compose.yml)

## ğŸ“Š SERVICE HEALTH MONITORING
- Run: [automation/scripts/check_service_health.sh](mdc:automation/scripts/check_service_health.sh)
- Dashboard: [CURRENT_STATUS.md](mdc:CURRENT_STATUS.md)
- Housekeeping: [automation/scripts/check_housekeeping_queue.sh](mdc:automation/scripts/check_housekeeping_queue.sh)
alwaysApply: true
---
<!-- Last optimized: 2025-10-02 -->

<!-- Last updated: 2025-10-02 -->
